INFO:     Will watch for changes in these directories: ['/Users/shrishesha/Developer/temp/demand_prediction/be']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [4264] using WatchFiles
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
INFO:main:CORS allowed origins: ['http://localhost:5173', 'http://localhost:3000', 'http://localhost:8080', 'https://pdpl.shrishesha.space']
INFO:     Started server process [4268]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:58210 - "GET /health HTTP/1.1" 200 OK
INFO:main:Loaded Hybrid models (SARIMAX + LSTM)
/Users/shrishesha/Developer/temp/demand_prediction/be/main.py:418: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  raw_df['date'] = pd.to_datetime(raw_df['date'])
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/statsmodels/tsa/base/tsa_model.py:473: ValueWarning: No frequency information was provided, so inferred frequency D will be used.
  self._init_dates(dates, freq)
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/statsmodels/tsa/base/tsa_model.py:473: ValueWarning: No frequency information was provided, so inferred frequency D will be used.
  self._init_dates(dates, freq)
INFO:main:predict_future_with_lstm: seed_data rows=30, n_in=30, forecast_days=182
INFO:main:predict_future_with_lstm: seed_data columns=['total_units', 'avg_price', 'promo_any', 'dow', 'dow_sin', 'dow_cos', 'doy_sin', 'doy_cos', 'residuals']
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/sklearn/utils/validation.py:2684: UserWarning: X has feature names, but MinMaxScaler was fitted without feature names
  warnings.warn(
INFO:main:Generated 182 future predictions
INFO:     10.0.0.5:58471 - "POST /forecast_future HTTP/1.1" 200 OK
INFO:main:Loaded Hybrid models (SARIMAX + LSTM)
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/statsmodels/tsa/base/tsa_model.py:473: ValueWarning: No frequency information was provided, so inferred frequency D will be used.
  self._init_dates(dates, freq)
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/statsmodels/tsa/base/tsa_model.py:473: ValueWarning: No frequency information was provided, so inferred frequency D will be used.
  self._init_dates(dates, freq)
INFO:main:predict_future_with_lstm: seed_data rows=30, n_in=30, forecast_days=182
INFO:main:predict_future_with_lstm: seed_data columns=['total_units', 'avg_price', 'promo_any', 'dow', 'dow_sin', 'dow_cos', 'doy_sin', 'doy_cos', 'residuals']
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/sklearn/utils/validation.py:2684: UserWarning: X has feature names, but MinMaxScaler was fitted without feature names
  warnings.warn(
INFO:main:Generated 182 future predictions
INFO:     10.0.0.5:58569 - "POST /forecast_future HTTP/1.1" 200 OK
INFO:main:Loaded Hybrid models (SARIMAX + LSTM)
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/statsmodels/tsa/base/tsa_model.py:473: ValueWarning: No frequency information was provided, so inferred frequency D will be used.
  self._init_dates(dates, freq)
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/statsmodels/tsa/base/tsa_model.py:473: ValueWarning: No frequency information was provided, so inferred frequency D will be used.
  self._init_dates(dates, freq)
INFO:main:predict_future_with_lstm: seed_data rows=30, n_in=30, forecast_days=546
INFO:main:predict_future_with_lstm: seed_data columns=['total_units', 'avg_price', 'promo_any', 'dow', 'dow_sin', 'dow_cos', 'doy_sin', 'doy_cos', 'residuals']
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/sklearn/utils/validation.py:2684: UserWarning: X has feature names, but MinMaxScaler was fitted without feature names
  warnings.warn(
INFO:main:Generated 546 future predictions
INFO:     10.0.0.5:58611 - "POST /forecast_future HTTP/1.1" 200 OK
INFO:main:Loaded Hybrid models (SARIMAX + LSTM)
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/statsmodels/tsa/base/tsa_model.py:473: ValueWarning: No frequency information was provided, so inferred frequency D will be used.
  self._init_dates(dates, freq)
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/statsmodels/tsa/base/tsa_model.py:473: ValueWarning: No frequency information was provided, so inferred frequency D will be used.
  self._init_dates(dates, freq)
INFO:main:predict_future_with_lstm: seed_data rows=30, n_in=30, forecast_days=91
INFO:main:predict_future_with_lstm: seed_data columns=['total_units', 'avg_price', 'promo_any', 'dow', 'dow_sin', 'dow_cos', 'doy_sin', 'doy_cos', 'residuals']
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/sklearn/utils/validation.py:2684: UserWarning: X has feature names, but MinMaxScaler was fitted without feature names
  warnings.warn(
INFO:main:Generated 91 future predictions
INFO:     10.0.0.5:58955 - "POST /forecast_future HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [4268]
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
INFO:main:CORS allowed origins: ['http://localhost:5173', 'http://localhost:3000', 'http://localhost:8080', 'https://pdpl.shrishesha.space']
INFO:     Started server process [5736]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [5736]
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
INFO:main:CORS allowed origins: ['http://localhost:5173', 'http://localhost:3000', 'http://localhost:8080', 'https://pdpl.shrishesha.space']
INFO:     Started server process [5783]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:main:Loaded Hybrid models (SARIMAX + LSTM)
INFO:main:Gap of 363 days detected. Bridging with SARIMAX forecast...
INFO:main:predict_future_with_lstm: seed_data rows=30, n_in=30, forecast_days=91
INFO:main:predict_future_with_lstm: seed_data columns=['total_units', 'avg_price', 'promo_any', 'dow', 'dow_sin', 'dow_cos', 'doy_sin', 'doy_cos', 'doy', 'residuals']
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/sklearn/utils/validation.py:2684: UserWarning: X has feature names, but MinMaxScaler was fitted without feature names
  warnings.warn(
INFO:main:Generated 91 future predictions
INFO:     10.0.0.5:59178 - "POST /forecast_future HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [5783]
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
INFO:main:CORS allowed origins: ['http://localhost:5173', 'http://localhost:3000', 'http://localhost:8080', 'https://pdpl.shrishesha.space']
INFO:     Started server process [6112]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [6112]
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
INFO:main:CORS allowed origins: ['http://localhost:5173', 'http://localhost:3000', 'http://localhost:8080', 'https://pdpl.shrishesha.space']
INFO:     Started server process [6153]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:main:Loaded Hybrid models (SARIMAX + LSTM)
INFO:main:Gap detected from 2024-12-31 to 2025-12-29. Bridging with previous year's data...
INFO:main:Successfully bridged gap using 362 days of data from the previous year.
INFO:main:predict_future_with_lstm: seed_data rows=30, n_in=30, forecast_days=91
INFO:main:predict_future_with_lstm: seed_data columns=['total_units', 'avg_price', 'promo_any', 'dow', 'dow_sin', 'dow_cos', 'doy_sin', 'doy_cos', 'residuals']
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/sklearn/utils/validation.py:2684: UserWarning: X has feature names, but MinMaxScaler was fitted without feature names
  warnings.warn(
INFO:main:Generated 91 future predictions
INFO:     10.0.0.5:59274 - "POST /forecast_future HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [6153]
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
INFO:main:CORS allowed origins: ['http://localhost:5173', 'http://localhost:3000', 'http://localhost:8080', 'https://pdpl.shrishesha.space']
INFO:     Started server process [6364]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [6364]
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
INFO:main:CORS allowed origins: ['http://localhost:5173', 'http://localhost:3000', 'http://localhost:8080', 'https://pdpl.shrishesha.space']
INFO:     Started server process [6390]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:main:Loaded Hybrid models (SARIMAX + LSTM)
INFO:main:Gap detected from 2024-12-31 to 2025-12-29. Bridging with previous year's data...
INFO:main:Successfully bridged gap using 362 days of data from the previous year.
INFO:main:predict_future_with_lstm: seed_data rows=30, n_in=30, forecast_days=91
INFO:main:predict_future_with_lstm: seed_data columns=['total_units', 'avg_price', 'promo_any', 'dow', 'dow_sin', 'dow_cos', 'doy_sin', 'doy_cos', 'residuals']
/Users/shrishesha/Developer/temp/demand_prediction/be/.venv/lib/python3.11/site-packages/sklearn/utils/validation.py:2684: UserWarning: X has feature names, but MinMaxScaler was fitted without feature names
  warnings.warn(
INFO:main:Generated 91 future predictions
INFO:     10.0.0.5:59434 - "POST /forecast_future HTTP/1.1" 200 OK
